// Copyright 2018-2023 the Deno authors. All rights reserved. MIT license.
// This module is browser compatible.
import { STATUS_TEXT } from "./http_status.ts";
import { deepMerge } from "../collections/deep_merge.ts";
/** Returns true if the etags match. Weak etag comparisons are handled. */ export function compareEtag(a, b) {
    if (a === b) {
        return true;
    }
    if (a.startsWith("W/") && !b.startsWith("W/")) {
        return a.slice(2) === b;
    }
    if (!a.startsWith("W/") && b.startsWith("W/")) {
        return a === b.slice(2);
    }
    return false;
}
/**
 * Internal utility for returning a standardized response, automatically defining the body, status code and status text, according to the response type.
 */ export function createCommonResponse(status, body, init) {
    if (body === undefined) {
        body = STATUS_TEXT[status];
    }
    init = deepMerge({
        status,
        statusText: STATUS_TEXT[status]
    }, init ?? {});
    return new Response(body, init);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjE4MS4wL2h0dHAvdXRpbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgMjAxOC0yMDIzIHRoZSBEZW5vIGF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuIE1JVCBsaWNlbnNlLlxuLy8gVGhpcyBtb2R1bGUgaXMgYnJvd3NlciBjb21wYXRpYmxlLlxuXG5pbXBvcnQgeyBTdGF0dXMsIFNUQVRVU19URVhUIH0gZnJvbSBcIi4vaHR0cF9zdGF0dXMudHNcIjtcbmltcG9ydCB7IGRlZXBNZXJnZSB9IGZyb20gXCIuLi9jb2xsZWN0aW9ucy9kZWVwX21lcmdlLnRzXCI7XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIGV0YWdzIG1hdGNoLiBXZWFrIGV0YWcgY29tcGFyaXNvbnMgYXJlIGhhbmRsZWQuICovXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZUV0YWcoYTogc3RyaW5nLCBiOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgaWYgKGEgPT09IGIpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoYS5zdGFydHNXaXRoKFwiVy9cIikgJiYgIWIuc3RhcnRzV2l0aChcIlcvXCIpKSB7XG4gICAgcmV0dXJuIGEuc2xpY2UoMikgPT09IGI7XG4gIH1cbiAgaWYgKCFhLnN0YXJ0c1dpdGgoXCJXL1wiKSAmJiBiLnN0YXJ0c1dpdGgoXCJXL1wiKSkge1xuICAgIHJldHVybiBhID09PSBiLnNsaWNlKDIpO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBJbnRlcm5hbCB1dGlsaXR5IGZvciByZXR1cm5pbmcgYSBzdGFuZGFyZGl6ZWQgcmVzcG9uc2UsIGF1dG9tYXRpY2FsbHkgZGVmaW5pbmcgdGhlIGJvZHksIHN0YXR1cyBjb2RlIGFuZCBzdGF0dXMgdGV4dCwgYWNjb3JkaW5nIHRvIHRoZSByZXNwb25zZSB0eXBlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29tbW9uUmVzcG9uc2UoXG4gIHN0YXR1czogU3RhdHVzLFxuICBib2R5PzogQm9keUluaXQgfCBudWxsLFxuICBpbml0PzogUmVzcG9uc2VJbml0LFxuKTogUmVzcG9uc2Uge1xuICBpZiAoYm9keSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYm9keSA9IFNUQVRVU19URVhUW3N0YXR1c107XG4gIH1cbiAgaW5pdCA9IGRlZXBNZXJnZSh7XG4gICAgc3RhdHVzLFxuICAgIHN0YXR1c1RleHQ6IFNUQVRVU19URVhUW3N0YXR1c10sXG4gIH0sIGluaXQgPz8ge30pO1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKGJvZHksIGluaXQpO1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDBFQUEwRTtBQUMxRSxxQ0FBcUM7QUFFckMsU0FBaUIsV0FBVyxRQUFRLGtCQUFrQixDQUFDO0FBQ3ZELFNBQVMsU0FBUyxRQUFRLDhCQUE4QixDQUFDO0FBRXpELHdFQUF3RSxHQUN4RSxPQUFPLFNBQVMsV0FBVyxDQUFDLENBQVMsRUFBRSxDQUFTLEVBQVc7SUFDekQsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ1gsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBQ0QsSUFBSSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUM3QyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFDRCxJQUFJLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQzdDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVEOztDQUVDLEdBQ0QsT0FBTyxTQUFTLG9CQUFvQixDQUNsQyxNQUFjLEVBQ2QsSUFBc0IsRUFDdEIsSUFBbUIsRUFDVDtJQUNWLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRTtRQUN0QixJQUFJLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDRCxJQUFJLEdBQUcsU0FBUyxDQUFDO1FBQ2YsTUFBTTtRQUNOLFVBQVUsRUFBRSxXQUFXLENBQUMsTUFBTSxDQUFDO0tBQ2hDLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ2YsT0FBTyxJQUFJLFFBQVEsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDbEMsQ0FBQyJ9